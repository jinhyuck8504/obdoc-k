# Requirements Document

## Introduction

현재 회원가입 시스템에서는 의사/한의사와 일반 고객이 동일한 가입 폼을 사용하여 불필요한 정보 노출과 혼란을 야기하고 있습니다. 또한 의료 서비스의 특성상 무분별한 가입을 방지하고 의료 안전성을 확보하기 위해 병원 코드 시스템과 고객 가입 코드 검증이 필요합니다. 이 기능은 사용자 역할에 따라 차별화된 가입 플로우를 제공하고, 의료진의 관리 하에 안전한 서비스 이용 환경을 구축하는 것을 목표로 합니다.

## Requirements

### Requirement 1

**User Story:** 일반 고객으로서, 병원에서 제공받은 가입 코드를 통해 안전하게 회원가입하고 싶습니다.

#### Acceptance Criteria

1. WHEN 일반 고객이 회원가입 페이지에 접근 THEN 시스템은 병원 가입 코드 입력을 필수로 요구해야 합니다
2. WHEN 일반 고객이 유효한 가입 코드를 입력 THEN 시스템은 해당 병원과 연결된 가입 폼을 제공해야 합니다
3. WHEN 일반 고객이 가입 폼을 작성 THEN 시스템은 구독 플랜 정보를 표시하지 않아야 합니다
4. WHEN 일반 고객이 가입을 완료 THEN 시스템은 해당 병원과 연결된 고객으로 등록하고 고객 대시보드로 리디렉션해야 합니다
5. IF 가입 코드가 유효하지 않거나 만료된 경우 THEN 시스템은 명확한 오류 메시지를 표시해야 합니다

### Requirement 2

**User Story:** 의사/한의사로서, 병원 고유 코드를 부여받고 2단계 가입 과정을 통해 구독 플랜을 선택하고 싶습니다.

#### Acceptance Criteria

1. WHEN 의사/한의사가 회원가입을 시작 THEN 시스템은 자동으로 병원 고유 코드를 생성하고 할당해야 합니다
2. WHEN 의사/한의사가 1단계(기본 정보 및 병원 정보)를 완료 THEN 시스템은 2단계(구독 플랜 선택)로 진행해야 합니다
3. WHEN 의사/한의사가 구독 플랜을 선택 THEN 시스템은 선택된 플랜 정보와 병원 코드를 함께 저장해야 합니다
4. WHEN 의사/한의사가 가입을 완료 THEN 시스템은 병원 코드와 구독 정보를 포함하여 의사 대시보드로 리디렉션해야 합니다

### Requirement 3

**User Story:** 의사/한의사로서, 내 병원의 고객 가입 코드를 생성하고 관리하고 싶습니다.

#### Acceptance Criteria

1. WHEN 의사가 대시보드에 접근 THEN 시스템은 고객 가입 코드 관리 기능을 제공해야 합니다
2. WHEN 의사가 새로운 가입 코드를 생성 THEN 시스템은 랜덤하고 안전한 코드를 생성해야 합니다
3. WHEN 의사가 가입 코드 유효기간을 설정 THEN 시스템은 설정된 기간 후 자동으로 코드를 만료시켜야 합니다
4. WHEN 의사가 가입 코드를 비활성화 THEN 시스템은 즉시 해당 코드로의 가입을 차단해야 합니다
5. WHEN 고객이 가입 코드를 사용 THEN 시스템은 사용 내역을 기록하고 의사에게 알림을 제공해야 합니다

### Requirement 4

**User Story:** 시스템 관리자로서, 병원별 코드와 가입 현황을 모니터링하고 관리하고 싶습니다.

#### Acceptance Criteria

1. WHEN 관리자가 병원 관리 페이지에 접근 THEN 시스템은 모든 병원의 고유 코드 목록을 제공해야 합니다
2. WHEN 관리자가 특정 병원을 조회 THEN 시스템은 병원 코드, 가입 현황, 구독 정보를 표시해야 합니다
3. WHEN 관리자가 가입 통계를 조회 THEN 시스템은 병원별, 기간별 가입 현황을 제공해야 합니다
4. WHEN 관리자가 가입 코드 사용 현황을 조회 THEN 시스템은 코드별 사용 횟수와 성공률을 제공해야 합니다
5. IF 의심스러운 가입 패턴이 감지된다면 THEN 시스템은 관리자에게 알림을 발송해야 합니다

### Requirement 5

**User Story:** 사용자로서, 가입 과정에서 내 역할에 맞는 적절한 안내와 보안이 강화된 환경을 경험하고 싶습니다.

#### Acceptance Criteria

1. WHEN 사용자가 회원가입 페이지에 접근 THEN 시스템은 역할 선택과 함께 보안 정책을 명확하게 안내해야 합니다
2. WHEN 사용자가 역할을 선택 THEN 시스템은 해당 역할에 맞는 보안 요구사항을 적용해야 합니다
3. WHEN 사용자가 가입 과정을 진행 THEN 시스템은 현재 단계와 보안 상태를 명확하게 표시해야 합니다
4. IF 사용자가 가입 과정 중 뒤로 가기를 원한다면 THEN 시스템은 보안을 유지하면서 이전 단계로 돌아갈 수 있는 기능을 제공해야 합니다

### Requirement 6

**User Story:** 개발자로서, 의료 서비스에 적합한 보안이 강화된 가입 시스템을 구현하고 싶습니다.

#### Acceptance Criteria

1. WHEN 새로운 가입 플로우가 구현 THEN 기존 인증 시스템과 완전히 호환되면서 보안이 강화되어야 합니다
2. WHEN 병원 코드가 생성 THEN 시스템은 중복되지 않는 고유한 코드를 보장해야 합니다
3. WHEN 가입 코드가 생성 THEN 시스템은 암호화된 형태로 저장하고 전송해야 합니다
4. IF 향후 새로운 사용자 역할이 추가된다면 THEN 시스템은 코드 시스템을 포함하여 쉽게 확장 가능해야 합니다
5. WHEN 가입 과정에서 오류가 발생 THEN 시스템은 보안을 유지하면서 적절한 에러 처리와 사용자 피드백을 제공해야 합니다

### Requirement 7

**User Story:** 의료진으로서, 내 병원 소속 고객들의 가입 및 활동 현황을 모니터링하고 싶습니다.

#### Acceptance Criteria

1. WHEN 의사가 고객 관리 페이지에 접근 THEN 시스템은 내 병원 코드로 가입한 고객 목록을 제공해야 합니다
2. WHEN 의사가 고객 상세 정보를 조회 THEN 시스템은 가입 경로와 사용 가입 코드 정보를 포함해야 합니다
3. WHEN 의사가 고객 활동을 모니터링 THEN 시스템은 안전한 범위 내에서 서비스 이용 현황을 제공해야 합니다
4. IF 고객이 부적절한 활동을 한다면 THEN 시스템은 의사에게 알림을 제공하고 적절한 조치 옵션을 제시해야 합니다
